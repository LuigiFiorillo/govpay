get_domini:
  tags:
    - Domini
  summary: Elenco dei domini beneficiari censiti
  parameters:
    - $ref: './comuni.yaml#/pagina'
    - $ref: './comuni.yaml#/risultatiPerPagina'
    - $ref: './comuni.yaml#/campi'
    - $ref: './comuni.yaml#/abilitato'
    - name: ordinamento
      in: query
      description: >-
        csv dei campi su cui ordinare i risultati, preceduti da + o - per ascendente o discendente (default ascendente)
         * ragioneSociale
      required: false
      schema:
        type: string
        format: csv
        default: +ragioneSociale
    - name: idStazione
      in: query
      description: Restrizione ai soli domini associati alla stazione indicata
      required: false
      schema:
        type: string
  responses:
    '200':
      description: Lista paginata dei domini ricercati
      content:
        application/json:
          schema:
            allOf:
              - $ref: './comuni.yaml#/listaPaginata'
              - type: object
                required:
                  - risultati
                properties:
                  risultati:
                    type: array
                    items:
                      $ref: '#/dominioIndex' 
    '401':
      $ref: './errori.yaml#/responses/401'
    '403':
      $ref: './errori.yaml#/responses/403'
    '500':
      $ref: './errori.yaml#/responses/500'
get_dominio:
  tags:
    - Domini
  summary: Lettura dei dati di un dominio beneficiario
  parameters:
    - in: path
      name: idDominio
      schema:
        type: string
      description: Codice fiscale del beneficiario
      required: true
  responses:
    '200':
      description: Dettaglio del dominio
      content:
        application/json:
          schema:
            $ref: '#/dominio'
    '401':
      $ref: './errori.yaml#/responses/401'
    '403':
      $ref: './errori.yaml#/responses/403'
    '404':
      $ref: './errori.yaml#/responses/404'          
    '500':
      $ref: './errori.yaml#/responses/500'
get_unitaoperative:
  tags:
    - Domini
  summary: Elenco delle unità operative del beneficiario
  parameters:
    - $ref: './comuni.yaml#/pagina'
    - $ref: './comuni.yaml#/risultatiPerPagina'
    - $ref: './comuni.yaml#/campi'
    - $ref: './comuni.yaml#/abilitato'
    - name: ordinamento
      in: query
      description: >-
        csv dei campi su cui ordinare i risultati, preceduti da + o - per ascendente o discendente (default ascendente)
         * ragioneSociale
      required: false
      schema:
        type: string
        format: csv
        default: +ragioneSociale        
    - name: idDominio
      in: path
      description: Identificativo del dominio
      required: true
      schema:
        type: string
  responses:
    '200':
      description: Lista paginata dei domini ricercati
      content:
        application/json:
          schema:
            allOf:
              - $ref: './comuni.yaml#/listaPaginata'
              - type: object
                required:
                  - risultati
                properties:
                  risultati:
                    type: array
                    items:
                      $ref: '#/unitaOperativa'
    '401':
      $ref: './errori.yaml#/responses/401'
    '403':
      $ref: './errori.yaml#/responses/403' 
    '500':
      $ref: './errori.yaml#/responses/500'
get_unitaoperativa:
  tags:
    - Domini
  summary: Lettura dei dati di una unità operativa
  parameters:
    - in: path
      name: idDominio
      schema:
        type: string
      description: Codice fiscale del beneficiario
      required: true
    - name: idUnitaOperativa
      in: path
      description: Identificativo dell'unità operativa
      required: true
      schema:
        type: string
  responses:
    '200':
      description: Dettaglio dell'unità operativa
      content:
        application/json:
          schema:
            $ref: '#/unitaOperativa'
    '401':
      $ref: './errori.yaml#/responses/401'
    '403':
      $ref: './errori.yaml#/responses/403' 
    '500':
      $ref: './errori.yaml#/responses/500'
get_ibans:
  tags:
    - Domini
  summary: Elenco degli iban di accredito del beneficiario
  parameters:
    - $ref: './comuni.yaml#/pagina'
    - $ref: './comuni.yaml#/risultatiPerPagina'
    - $ref: './comuni.yaml#/campi'
    - $ref: './comuni.yaml#/abilitato'      
    - name: ordinamento
      in: query
      description: >-
        csv dei campi su cui ordinare i risultati, preceduti da + o - per ascendente o discendente (default ascendente)
         * ragioneSociale
      required: false
      schema:
        type: string
        format: csv
        default: +contiAccredito        
    - name: idDominio
      in: path
      description: Identificativo del dominio
      required: true
      schema:
        type: string      
  responses:
    '200':
      description: Lista paginata dei domini ricercati
      content:
        application/json:
          schema:
            allOf:
              - $ref: './comuni.yaml#/listaPaginata'
              - type: object
                required:
                  - risultati
                properties:
                  risultati:
                    type: array
                    items:
                      $ref: '#/contiAccredito'
    '401':
      $ref: './errori.yaml#/responses/401'
    '403':
      $ref: './errori.yaml#/responses/403' 
    '500':
      $ref: './errori.yaml#/responses/500'
get_iban:
  tags:
    - Domini
  summary: Lettura dei dati di un iban di accredito
  parameters:
    - in: path
      name: idDominio
      schema:
        type: string
      description: Codice fiscale del beneficiario
      required: true
    - name: iban
      in: path
      description: Iban
      required: true
      schema:
        type: string
  responses:
    '200':
      description: Dettaglio dell'iban di accredito
      content:
        application/json:
          schema:
            $ref: '#/contiAccredito'
    '401':
      $ref: './errori.yaml#/responses/401'
    '403':
      $ref: './errori.yaml#/responses/403' 
    '500':
      $ref: './errori.yaml#/responses/500'
get_entrate:
  tags:
    - Domini
  summary: Elenco delle tipologie di entrata del dominio
  parameters:
    - $ref: './comuni.yaml#/pagina'
    - $ref: './comuni.yaml#/risultatiPerPagina'
    - $ref: './comuni.yaml#/campi'
    - $ref: './comuni.yaml#/abilitato' 
    - name: ordinamento
      in: query
      description: >-
        csv dei campi su cui ordinare i risultati, preceduti da + o - per ascendente o discendente (default ascendente)
         * idEntrata
      required: false
      schema:
        type: string
        format: csv
        default: +idEntrata
    - name: idDominio
      in: path
      description: Identificativo del dominio
      required: true
      schema:
        type: string      
  responses:
    '200':
      description: Lista paginata delle entrate ricercate
      content:
        application/json:
          schema:
            allOf:
              - $ref: './comuni.yaml#/listaPaginata'
              - type: object
                required:
                  - risultati
                properties:
                  risultati:
                    type: array
                    items:
                      $ref: '#/entrata'
    '401':
      $ref: './errori.yaml#/responses/401'
    '403':
      $ref: './errori.yaml#/responses/403' 
    '500':
      $ref: './errori.yaml#/responses/500'
get_entrata:
  tags:
    - Domini
  summary: Lettura dei dati di una entrata
  parameters:
    - in: path
      name: idDominio
      schema:
        type: string
      description: Codice fiscale del beneficiario
      required: true
    - name: idEntrata
      in: path
      description: Identificativo della tipologia di entrata
      required: true
      schema:
        type: string
  responses:
    '200':
      description: Dettaglio dell'entrata
      content:
        application/json:
          schema:
            $ref: '#/entrata'
    '401':
      $ref: './errori.yaml#/responses/401'
    '403':
      $ref: './errori.yaml#/responses/403' 
    '500':
      $ref: './errori.yaml#/responses/500'
dominioPost:
  type: object
  required:
   - ragioneSociale
   - gln
   - stazione
   - abilitato
  properties:
    ragioneSociale:
      type: string
      description: Ragione sociale del beneficiario
      example: Ente Creditore
    indirizzo:
      type: string
      description: Indirizzo del beneficiario
      example: Corso Italia
    civico:
      type: string
      description: Numero civico del beneficiario
      example: 1A
    cap:
      type: string
      description: Codice avviamento postale del beneficiario
      example: 00000
    localita:
      type: string
      description: Località del beneficiario
      example: Roma
    provincia:
      type: string
      description: Provincia del beneficiario
      example: Roma
    nazione:
      type: string
      description: Nazione del beneficiario
      example: IT
    email:
      type: string
      description: Posta elettronica ordinaria del beneficiario
      example: peo@creditore.it  
    pec:
      type: string
      description: Posta elettronica certificata del beneficiario
      example: pec@creditore.it  
    tel:
      type: string
      description: Numero di telefono dell'help desk del beneficiario
      example: 021234567890  
    fax:
      type: string
      description: Numero di fax dell'help desk del beneficiario
      example: 021234567890  
    web:
      type: string
      description: Url del sito web
      example: http://www.comune.it/
    gln:
      type: string
      description: Global location number del beneficiario
      example: 0011223344556
    cbill:
      type: string
      description: codice cbill del beneficiario
      example: 12345
    iuvPrefix:
      type: string
      description: Prefisso negli IUV generati da GovPay
      example: '%(yyyy)%(a)'
    stazione:
      type: string
      description: Codice stazione PagoPA che intermedia il beneficiario
      example: 01234567890_01
    auxDigit:
      type: string
      description: Valore della prima cifra dei Numero Avviso generati da GovPay
      example: 0
    segregationCode:
      type: string
      description: Codice di segregazione utilizzato in caso di beneficiario pluri-intermediato (auxDigit = 3)
      example: 88
    logo:
      type: string
      description: Base64 del logo del beneficiario
      example: /9j/4AA...base64...FFFFABRRRQB/9k=
    abilitato:
      type: boolean
      description: Indicazione se il creditore è abilitato ad operare sulla piattaforma
      example: 'true'
dominioIndex:
  type: object
  allOf:
    - type: object
      required:
        - idDominio
      properties:
        idDominio:
          type: string
          description: Codice fiscale del beneficiario
          example: 01234567890
    - $ref: '#/dominioPost'
    - type: object
      properties:
        required:
        - unitaOperative
        - contiAccredito
        - entrate
        unitaOperative:
          type: string
          description: Url alle unità operative censite per il dominio
          example: /domini/01234567890/unitaOperative
        contiAccredito:
          type: string
          description: Conti di accredito censiti per il dominio beneficiario
          example: /domini/01234567890/contiAccredito
        entrate:
          type: string
          description: Tipologie di entrata censite per il dominio beneficiario
          example: /domini/01234567890/entrate               
dominio:
  type: object
  allOf:
    - type: object
      required:
        - idDominio
      properties:
        idDominio:
          type: string
          description: Codice fiscale del beneficiario
          example: 01234567890
    - $ref: '#/dominioPost'
    - type: object
      properties:
        unitaOperative:
          type: array
          items:
            $ref: '#/unitaOperativa'
        contiAccredito:
          type: array
          items:
            $ref: '#/contiAccredito'
        entrate:
          type: array
          items:
            $ref: '#/entrata'           
unitaOperativaPost:
  type: object
  required: 
    - ragioneSociale
  properties:
    ragioneSociale:
      type: string
      description: Ragione sociale dell'unita
      example: Ufficio due
    indirizzo:
      type: string
      description: Indirizzo dell'unita
      example: Borgo stretto
    civico:
      type: string
      description: Numero civico dell'unita
      example: 55bis
    cap:
      type: string
      description: Codice avviamento postale dell'unita
      example: 99999
    localita:
      type: string
      description: Località dell'unita
      example: Milano
    provincia:
      type: string
      description: Provincia del beneficiario
      example: Roma
    nazione:
      type: string
      description: Nazione del beneficiario
      example: IT
    email:
      type: string
      description: Posta elettronica ordinaria del beneficiario
      example: peo@creditore.it  
    pec:
      type: string
      description: Posta elettronica certificata del beneficiario
      example: pec@creditore.it  
    tel:
      type: string
      description: Numero di telefono dell'help desk del beneficiario
      example: 021234567890  
    fax:
      type: string
      description: Numero di fax dell'help desk del beneficiario
      example: 021234567890           
    gln:
      type: string
      description: Global location number del beneficiario
      example: 0011223344556
    web:
      type: string
      description: Url del sito web
      example: http://www.comune.it/
    area:
      type: string
      description: Nome dell'area di competenza dell'unita' operativa
      example: Affari generali e istituzionali  
    abilitato:
      type: boolean
      description: Indica lo stato di abilitazione
      example: true
unitaOperativa:
  type: object
  allOf:
    - type: object
      required:
       - idUnita
      properties:
        idUnita:
          type: string
          description: Codice fiscale dell'unita
          example: 01234567890
    - $ref: '#/unitaOperativaPost'
contiAccreditoPost:
  type: object
  properties:
    bic:
      type: string
      example: DABAIE2D
    postale:
      type: boolean
      description: indica se e' un c/c postale
      example: false
      default: false
    mybank:
      type: boolean
      description: indica se e' un iban abilitato sul circuito mybank
      example: false
      default: false
    abilitato:
      type: boolean
      description: Indicazione se il creditore è abilitato ad operare sulla piattaforma
      example: true
      default: true
contiAccredito:
  type: object
  allOf:
    - type: object
      required:
       - idUnita
      properties:
        iban:
          type: string
          example: IT60X0542811101000000123456
    - $ref: '#/contiAccreditoPost'
tipoEntrataPost:
  type: object
  required: 
    - descrizione
    - tipoContabilita
    - codiceContabilita
  properties:
    descrizione:
      type: string
      example: Imposta municipale urbana
    tipoContabilita:
      description: Tipologia di codifica del capitolo di bilancio
      type: string
      enum:
        - Entrata
        - Speciale
        - SIOPE
        - Altro
      example: SIOPE
    codiceContabilita:
      description: Codifica del capitolo di bilancio
      type: string
      example: 3321
    codificaIUV:
      type: string
      description: Cifra identificativa negli IUV
      example: 01
tipoEntrata:
  type: object
  allOf:
    - type: object
      required:
       - idEntrata
      properties:
        idEntrata:
          type: string
          example: IMU
    - $ref: '#/tipoEntrataPost'
entrataPost:
  type: object
  required: 
    - contiAccredito
  properties:
    contoAccredito:
      type: string
      example: IT60X0542811101000000123456
    contoAppoggio:
      type: string
      example: IT60X0542811101000000123456
    tipoContabilita:
      description: Tipologia di codifica del capitolo di bilancio
      type: string
      enum:
        - Entrata
        - Speciale
        - SIOPE
        - Altro
      example: SIOPE
    codiceContabilita:
      description: Codifica del capitolo di bilancio
      type: string
      example: 3321
    codificaIUV:
      type: string
      description: Cifra identificativa negli IUV
      example: 01
    abilitato:
      type: boolean
      description: Indicazione l'entrata e' abilitata
      example: true
      default: true
entrata:
  type: object
  allOf:
    - type: object
      required:
       - idEntrata
      properties:
        idEntrata:
          type: string
          example: IMU
    - $ref: '#/entrataPost'
    - type: object
      required:
       - tipoEntrata
      properties:
        tipoEntrata:
          $ref: '#/tipoEntrata'