pendenzaBase:
  type: object
  required:
    - idDominio
    - soggettoPagatore
    - importo
    - causale
  properties:
    nome:
      type: string
      description: Nome della pendenza da visualizzare sui portali di pagamento e console di gestione.
      example: 'Immatricolazione AA 2017/2018'
    causale:
      type: string
      description: Descrizione da inserire nell'avviso di pagamento
      example: 'Sanzione CdS n. abc00000'
    soggettoPagatore:
      $ref: './comuni.yaml#/soggetto'
    importo:
      type: number
      description: Importo della pendenza. Deve corrispondere alla somma delle singole voci.
      example: 10.01
    numeroAvviso:
      type: string
      description: Identificativo univoco versamento, assegnato se pagabile da psp
      example: 123456789012345678
    dataCaricamento:
      type: string
      format: date
      description: Data di emissione della pendenza
      example: '2010-12-31'
    dataValidita:
      type: string
      format: date
      description: Data di validita dei dati della pendenza, decorsa la quale la pendenza può subire variazioni.
      example: '2019-12-31'
    dataScadenza:
      type: string
      format: date
      description: Data di scadenza della pendenza, decorsa la quale non è più pagabile.
      example: '2020-12-31'
    annoRiferimento:
      type: number
      description: Anno di riferimento della pendenza
      example: 2020
    cartellaPagamento:
      type: string
      description: Identificativo della cartella di pagamento a cui afferisce la pendenza
      example: ABC00000001
    datiAllegati:
      type: string
      description: Dati applicativi allegati dal gestionale secondo un formato proprietario.          
    tassonomia:
      type: string
      description: Macro categoria della pendenza secondo la classificazione del creditore
      example: Sanzioni
    tassonomiaAvviso:
      $ref: '#/tassonomiaAvviso'
pendenzaPut:
  type: object
  allOf:
    - type: object
      required:
        - idDominio
      properties:
        idDominio:
          type: string
          description: Identificativo del dominio creditore
          example: 1234567890
        idUnitaOperativa:
          type: string
          description: Identificativo dell'unita' operativa
          example: UO33132
    - $ref: '#/pendenzaBase'    
    - type: object
      required:
        - voci
      properties:   
        voci:
          type: array
          minItems: 1
          maxItems: 5
          items:
            $ref: '#/vocePendenza'
pendenzaPost:
  allOf:
    - type: object
      required:
        - idA2A
        - idPendenza
        - dominio
      properties:
        idA2A:
          type: string
          description: Identificativo del gestionale responsabile della pendenza
          example: A2A_12345
        idPendenza:
          type: string
          description: Identificativo della pendenza nel gestionale responsabile
          example: abcdef12345
    - $ref: '#/pendenzaPut'        
pendenzaIndex:
  type: object
  allOf:
    - type: object
      required:
        - idA2A
        - idPendenza
        - dominio
        - stato
        - dataCaricamento        
      properties:
        idA2A:
          type: string
          description: Identificativo del gestionale responsabile della pendenza
          example: A2A-12345
        idPendenza:
          type: string
          description: Identificativo della pendenza nel gestionale responsabile
          example: abcdef12345
        dominio:
          $ref: './dominio.yaml#/dominioIndex'
        unitaOperativa:
          $ref: './dominio.yaml#/unitaOperativa'
        stato:
          $ref: './statoPendenza'
        segnalazioni:
          type: array
          items: 
            $ref: '#/components/schemas/segnalazione'          
    - $ref: '#/pendenzaBase'   
    - type: object
      required:
        - rpp
        - pagamenti
      properties:
        rpp:
          type: string
          description: Url per l'elenco delle rpp emesse per la pendenza
          example: '/rpp?idPendenza=idA2A=A2A-12345&abcdef12345'
        pagamenti:
          type: string
          description: Url per l'elenco dei pagamenti da portale comprensivi della pendenza
          example: '/pagamenti?idA2A=A2A-12345&idPendenza=abcdef12345'  
pendenza:
  type: object
  allOf:
    - type: object
      required:
        - idA2A
        - idPendenza
        - dominio
        - stato
        - dataCaricamento        
      properties:
        idA2A:
          type: string
          description: Identificativo del gestionale responsabile della pendenza
          example: A2A-12345
        idPendenza:
          type: string
          description: Identificativo della pendenza nel gestionale responsabile
          example: abcdef12345
        dominio:
          $ref: './dominio.yaml#/dominioIndex'
        unitaOperativa:
          $ref: './dominio.yaml#/unitaOperativa'
        stato:
          $ref: '#/statoPendenza'
        segnalazioni:
          type: array
          items: 
            $ref: './comuni.yaml#/segnalazione'          
    - $ref: '#/pendenzaBase'   
    - type: object
      required:
        - voci
        - rpp
        - pagamenti
      properties:
        voci:
          type: array
          minItems: 1
          maxItems: 5
          items:
            $ref: '#/vocePendenza'
        rpp:
          type: array
          items:
            $ref: './rpp.yaml#/rpp'
        pagamenti:
          type: array
          items:
            $ref: './pagamenti.yaml#/pagamento'        
vocePendenza:
  allOf:
    - type: object
      required:
        - idVocePendenza
        - importo
        - descrizione
      properties:
        indice:
          type: number
          description: indice di voce all'interno della pendenza
          example: 1
        idVocePendenza:
          type: string
          description: Identificativo della voce di pedenza nel gestionale proprietario
          example: abcdef12345_1
        importo:
          type: number
          description: Importo della voce
          example: 10.01
        descrizione:
          type: string
          description: descrizione della voce di pagamento
          example: Sanzione CdS n. abc00000
        datiAllegati:
          type: string
          description: Dati applicativi allegati dal gestionale secondo un formato proprietario.
    - oneOf:
        - description: Definisce i dettagli di incasso tramite riferimento in anagrafica GovPay.
          type: object
          required:
            - codEntrata
          properties:
            codEntrata:
              type: string
        - description: Definisce i dettagli di incasso.
          type: object
          required:
            - ibanAccredito
            - tipoContabilita
            - codiceContabilita
          properties:
            ibanAccredito:
              type: string
              example: IT60X0542811101000000123456
            ibanAppoggio:
              type: string
              example: IT60X0542811101000000123456
            tipoContabilita:
              description: Tipologia di codifica del capitolo di bilancio
              type: string
              enum:
                - Entrata
                - Speciale
                - SIOPE
                - Altro
              example: SIOPE
            codiceContabilita:
              description: Codifica del capitolo di bilancio
              type: string
              example: 3321
        - description: Definisce i dati di un bollo telematico
          type: object
          required:
            - tipoBollo
            - hashDocumento
            - provinciaResidenza
          properties:
            tipoBollo:
              description: Tipologia di Bollo digitale
              type: string
              enum:
                - Imposta di bollo
            hashDocumento:
              description: Digest in base64 del documento informatico associato alla marca da bollo
              type: string
            provinciaResidenza:
              description: Sigla automobilistica della provincia di residenza del soggetto pagatore
              type: string
tassonomiaAvviso:
  description: Macro categoria della pendenza Agid
  type: string
  enum:
    - Cartelle esattoriali
    - Diritti e concessioni
    - Imposte e tasse
    - IMU, TASI e altre tasse comunali
    - Ingressi a mostre e musei
    - Multe e sanzioni amministrative
    - Previdenza e infortuni
    - Servizi erogati dal comune
    - Servizi erogati da altri enti
    - Servizi scolastici
    - Tassa automobilistica
    - Ticket e prestazioni sanitarie
    - Trasporti, mobilità e parcheggi
  example: 
    Ticket e prestazioni sanitarie
statoPendenza:
  example: NON_ESEGUITO
  type: string
  enum:
    - ESEGUITA
    - NON_ESEGUITA
    - ESEGUITA_PARZIALE
    - ANNULLATA
    - SCADUTA
  description: >-
    Stato della pendenza: 
     * ESEGUITA: Pagata
     * NON_ESEGUITA: Da pagare
     * ESEGUITA_PARZIALE: Pagata parzialmente
     * ANNULLATA: Annullata
     * SCADUTA: Scaduta    