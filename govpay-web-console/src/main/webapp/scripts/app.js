String.prototype.endsWith||(String.prototype.endsWith=function(e,n){var o=this.toString();(void 0===n||n>o.length)&&(n=o.length),n-=e.length;var t=o.indexOf(e,n);return t!==-1&&t===n});var REST_SERVER=location.protocol+'//'+location.hostname+(location.port ? ':'+location.port: ''),BASE_URL=location.pathname;BASE_URL.endsWith("/index.html")&&(BASE_URL=BASE_URL.substring(0,BASE_URL.length-11)),BASE_URL.endsWith("/")&&(BASE_URL=BASE_URL.substring(0,BASE_URL.length-1));var LOGIN_URL=BASE_URL,REST_URL=REST_SERVER+BASE_URL+"/rs",MENU_URL=REST_URL+"/dars/",USER_INFO_URL=REST_URL+"/dars/operatori/user";!function(e){"use strict";var n=e.querySelector("#app");n.USER_LOGGED=null,n.ADVANCED_MODE=!1,n.numSpinner=0,n.LANGUAGE="it",n.RESOURCES={},n.baseUrl="/",""===window.location.port,n.openDrawer=function(e){this.$.drawerPanel.openDrawer()},n.closeDrawer=function(e){this.$.drawerPanel.closeDrawer()},n.scrollPageToTop=function(){},n.showSpinner=function(){n.numSpinner++,this.$.spinner.setSpinner(!0)},n.hideSpinner=function(){n.numSpinner--,0==n.numSpinner&&this.$.spinner.setSpinner(!1)},n.showPaperToast=function(e,n){this.$.toast.toggleClass("fit-bottom",!1),this.$.toast.toggleClass("success",!1),this.$.toast.toggleClass("error",!1),this.$.toast.toggleClass("warning",!1),n&&(this.$.toast.toggleClass(n,!0),this.$.toast.toggleClass("fit-bottom",!0)),Polymer.updateStyles(),this.$.toast.text=e,this.$.toast.show()},n.displayInstalledToast=function(){Polymer.dom(e).querySelector("platinum-sw-cache").disabled||Polymer.dom(e).querySelector("#caching-complete").show()},n.addEventListener("dom-change",function(){console.log("Our app is ready to rock!"),n.getUserInfo()}),window.addEventListener("WebComponentsReady",function(){}),n.getUserInfo=function(){this.$.getUserInfo.url=USER_INFO_URL,this.$.getUserInfo.generateRequest()},n.getUserInfo_responseHandler=function(e){var o=e.detail.response;switch(o.esitoOperazione){case"ESEGUITA":n.USER_LOGGED=e.detail.response.response,n.getConsoleInfo();break;case"NONESEGUITA":window.location=n.getDoLogoutURL();break;case"ERRORE":window.location=n.getDoLogoutURL()}},n.getUserInfo_errorHandler=function(e){this.dars_errorHandler(e)},n.getConsoleInfo=function(){this.$.getConsoleInfo.url=MENU_URL,this.$.getConsoleInfo.generateRequest()},n.getConsoleURL=function(){return REST_URL},n.getLoginURL=function(){return REST_SERVER+BASE_URL+"/"},n.getLogoutOkURL=function(){return REST_SERVER+BASE_URL+"/?msg=lo"},n.getNonAutorizzatoURL=function(){return REST_SERVER+BASE_URL+"/?msg=na"},n.getSessioneScadutaURL=function(){return REST_SERVER+BASE_URL+"/?msg=se"},n.getDoLogoutURL=function(){return REST_SERVER+BASE_URL+"/logout?msg=er"},n.getConsoleInfo_responseHandler=function(o){var t="";o.detail.response.response.menu.home?(this.$.mainModule.title=o.detail.response.response.menu.home.label,this.$.mainModule.resource=o.detail.response.response.menu.home.uri,t=o.detail.response.response.menu.home.uri):this.$.mainModule.title=o.detail.response.response.titolo,o.detail.response.response.lingue&&(n.RESOURCES=o.detail.response.response.lingue,e.dispatchEvent(new CustomEvent("change-language")));for(var s=0;s<o.detail.response.response.menu.sezioni.length;s++){var r=o.detail.response.response.menu.sezioni[s];r.vociMenu&&r.vociMenu.length>0?(r.haVoci=!0,r.opened=!1):(r.haVoci=!1,r.opened=!1);for(var i=0;i<r.vociMenu.length;i++){var a=r.vociMenu[i];a.uri==t&&(r.opened=!0,r.selected=i)}}n.consoleInfo=o.detail.response.response},n.getConsoleInfo_errorHandler=function(e){this.dars_errorHandler(e)},n.toggleMenu=function(e){for(var o=e.model.index,t=0;t<n.consoleInfo.menu.sezioni.length;t++){n.consoleInfo.menu.sezioni[t];t==o?n.set("consoleInfo.menu.sezioni."+t+".opened",!e.model.item.opened):n.set("consoleInfo.menu.sezioni."+t+".opened",!1)}},n.loadModule=function(e){for(var o=this.$.mainMenu.selectedClass,t=this.$.mainMenu.querySelectorAll('iron-collapse paper-item[class*="'+o+'"]'),s=0;s<t.length;s++)this.toggleClass(o,!1,t[s]);this.toggleClass(o,!0,e.currentTarget),this.$.mainModule.title=e.target.dataItem.label,this.$.mainModule.resource=e.target.dataItem.uri,n.closeDrawer()},n.dars_errorHandler=function(e){n.showPaperToast("Errore","error");var o=e.detail.request.status;401==o?window.location=n.getNonAutorizzatoURL():403==o?window.location=n.getSessioneScadutaURL():500==o&&(window.location=n.getDoLogoutURL())},n.appendLangParameter=function(e){var o=e.indexOf("?")>-1?"&":"?";return o+"lang="+n.LANGUAGE},n.showAbout=function(){e.querySelector("link-info-action").showAbout()}}(document);